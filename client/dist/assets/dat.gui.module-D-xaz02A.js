import{L as Qe,f as qe,B as Ae,C as Je,g as et,c as _e,V as R,F as Oe,R as tt,h as it,i as nt,j as Q,k as Z,Q as Te,l as ke,m as D,n as st}from"./three.module-DaOiP1Qo.js";class Ut extends Qe{constructor(e){super(e)}load(e,t,n,s){const o=this,r=new qe(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,function(h){try{t(o.parse(h))}catch(d){s?s(d):console.error(d),o.manager.itemError(e)}},n,s)}parse(e){function t(_){const c=new DataView(_),u=32/8*3+32/8*3*3+16/8,p=c.getUint32(80,!0);if(80+32/8+p*u===c.byteLength)return!0;const m=[115,111,108,105,100];for(let f=0;f<5;f++)if(n(m,c,f))return!1;return!0}function n(_,c,u){for(let p=0,v=_.length;p<v;p++)if(_[p]!==c.getUint8(u+p))return!1;return!0}function s(_){const c=new DataView(_),u=c.getUint32(80,!0);let p,v,m,f=!1,y,T,F,O,P;for(let C=0;C<70;C++)c.getUint32(C,!1)==1129270351&&c.getUint8(C+4)==82&&c.getUint8(C+5)==61&&(f=!0,y=new Float32Array(u*3*3),T=c.getUint8(C+6)/255,F=c.getUint8(C+7)/255,O=c.getUint8(C+8)/255,P=c.getUint8(C+9)/255);const S=84,x=12*4+2,H=new Ae,I=new Float32Array(u*3*3),U=new Float32Array(u*3*3),Y=new Je;for(let C=0;C<u;C++){const G=S+C*x,ue=c.getFloat32(G,!0),se=c.getFloat32(G+4,!0),oe=c.getFloat32(G+8,!0);if(f){const k=c.getUint16(G+48,!0);k&32768?(p=T,v=F,m=O):(p=(k&31)/31,v=(k>>5&31)/31,m=(k>>10&31)/31)}for(let k=1;k<=3;k++){const ce=G+k*12,B=C*3*3+(k-1)*3;I[B]=c.getFloat32(ce,!0),I[B+1]=c.getFloat32(ce+4,!0),I[B+2]=c.getFloat32(ce+8,!0),U[B]=ue,U[B+1]=se,U[B+2]=oe,f&&(Y.setRGB(p,v,m,et),y[B]=Y.r,y[B+1]=Y.g,y[B+2]=Y.b)}}return H.setAttribute("position",new _e(I,3)),H.setAttribute("normal",new _e(U,3)),f&&(H.setAttribute("color",new _e(y,3)),H.hasColors=!0,H.alpha=P),H}function o(_){const c=new Ae,u=/solid([\s\S]*?)endsolid/g,p=/facet([\s\S]*?)endfacet/g,v=/solid\s(.+)/;let m=0;const f=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,y=new RegExp("vertex"+f+f+f,"g"),T=new RegExp("normal"+f+f+f,"g"),F=[],O=[],P=[],S=new R;let x,H=0,I=0,U=0;for(;(x=u.exec(_))!==null;){I=U;const Y=x[0],C=(x=v.exec(Y))!==null?x[1]:"";for(P.push(C);(x=p.exec(Y))!==null;){let se=0,oe=0;const k=x[0];for(;(x=T.exec(k))!==null;)S.x=parseFloat(x[1]),S.y=parseFloat(x[2]),S.z=parseFloat(x[3]),oe++;for(;(x=y.exec(k))!==null;)F.push(parseFloat(x[1]),parseFloat(x[2]),parseFloat(x[3])),O.push(S.x,S.y,S.z),se++,U++;oe!==1&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+m),se!==3&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+m),m++}const G=I,ue=U-I;c.userData.groupNames=P,c.addGroup(G,ue,H),H++}return c.setAttribute("position",new Oe(F,3)),c.setAttribute("normal",new Oe(O,3)),c}function r(_){return typeof _!="string"?new TextDecoder().decode(_):_}function h(_){if(typeof _=="string"){const c=new Uint8Array(_.length);for(let u=0;u<_.length;u++)c[u]=_.charCodeAt(u)&255;return c.buffer||c}else return _}const d=h(e);return t(d)?s(d):o(r(e))}}const Pe={type:"change"},Ee={type:"start"},ze={type:"end"},ae=new tt,De=new it,ot=Math.cos(70*st.DEG2RAD),w=new R,A=2*Math.PI,g={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},fe=1e-6;class jt extends nt{constructor(e,t=null){super(e,t),this.state=g.NONE,this.enabled=!0,this.target=new R,this.cursor=new R,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Q.ROTATE,MIDDLE:Q.DOLLY,RIGHT:Q.PAN},this.touches={ONE:Z.ROTATE,TWO:Z.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new R,this._lastQuaternion=new Te,this._lastTargetPosition=new R,this._quat=new Te().setFromUnitVectors(e.up,new R(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new ke,this._sphericalDelta=new ke,this._scale=1,this._panOffset=new R,this._rotateStart=new D,this._rotateEnd=new D,this._rotateDelta=new D,this._panStart=new D,this._panEnd=new D,this._panDelta=new D,this._dollyStart=new D,this._dollyEnd=new D,this._dollyDelta=new D,this._dollyDirection=new R,this._mouse=new D,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=rt.bind(this),this._onPointerDown=at.bind(this),this._onPointerUp=lt.bind(this),this._onContextMenu=pt.bind(this),this._onMouseWheel=ut.bind(this),this._onKeyDown=ct.bind(this),this._onTouchStart=_t.bind(this),this._onTouchMove=ft.bind(this),this._onMouseDown=ht.bind(this),this._onMouseMove=dt.bind(this),this._interceptControlDown=mt.bind(this),this._interceptControlUp=gt.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(e){e.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=e}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Pe),this.update(),this.state=g.NONE}update(e=null){const t=this.object.position;w.copy(t).sub(this.target),w.applyQuaternion(this._quat),this._spherical.setFromVector3(w),this.autoRotate&&this.state===g.NONE&&this._rotateLeft(this._getAutoRotationAngle(e)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let n=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(n)&&isFinite(s)&&(n<-Math.PI?n+=A:n>Math.PI&&(n-=A),s<-Math.PI?s+=A:s>Math.PI&&(s-=A),n<=s?this._spherical.theta=Math.max(n,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(n+s)/2?Math.max(n,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const r=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=r!=this._spherical.radius}if(w.setFromSpherical(this._spherical),w.applyQuaternion(this._quatInverse),t.copy(this.target).add(w),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let r=null;if(this.object.isPerspectiveCamera){const h=w.length();r=this._clampDistance(h*this._scale);const d=h-r;this.object.position.addScaledVector(this._dollyDirection,d),this.object.updateMatrixWorld(),o=!!d}else if(this.object.isOrthographicCamera){const h=new R(this._mouse.x,this._mouse.y,0);h.unproject(this.object);const d=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=d!==this.object.zoom;const _=new R(this._mouse.x,this._mouse.y,0);_.unproject(this.object),this.object.position.sub(_).add(h),this.object.updateMatrixWorld(),r=w.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;r!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(r).add(this.object.position):(ae.origin.copy(this.object.position),ae.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ae.direction))<ot?this.object.lookAt(this.target):(De.setFromNormalAndCoplanarPoint(this.object.up,this.target),ae.intersectPlane(De,this.target))))}else if(this.object.isOrthographicCamera){const r=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),r!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>fe||8*(1-this._lastQuaternion.dot(this.object.quaternion))>fe||this._lastTargetPosition.distanceToSquared(this.target)>fe?(this.dispatchEvent(Pe),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(e){return e!==null?A/60*this.autoRotateSpeed*e:A/60/60*this.autoRotateSpeed}_getZoomScale(e){const t=Math.abs(e*.01);return Math.pow(.95,this.zoomSpeed*t)}_rotateLeft(e){this._sphericalDelta.theta-=e}_rotateUp(e){this._sphericalDelta.phi-=e}_panLeft(e,t){w.setFromMatrixColumn(t,0),w.multiplyScalar(-e),this._panOffset.add(w)}_panUp(e,t){this.screenSpacePanning===!0?w.setFromMatrixColumn(t,1):(w.setFromMatrixColumn(t,0),w.crossVectors(this.object.up,w)),w.multiplyScalar(e),this._panOffset.add(w)}_pan(e,t){const n=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;w.copy(s).sub(this.target);let o=w.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*e*o/n.clientHeight,this.object.matrix),this._panUp(2*t*o/n.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(e*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrix),this._panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(e){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(e,t){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const n=this.domElement.getBoundingClientRect(),s=e-n.left,o=t-n.top,r=n.width,h=n.height;this._mouse.x=s/r*2-1,this._mouse.y=-(o/h)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(e){return Math.max(this.minDistance,Math.min(this.maxDistance,e))}_handleMouseDownRotate(e){this._rotateStart.set(e.clientX,e.clientY)}_handleMouseDownDolly(e){this._updateZoomParameters(e.clientX,e.clientX),this._dollyStart.set(e.clientX,e.clientY)}_handleMouseDownPan(e){this._panStart.set(e.clientX,e.clientY)}_handleMouseMoveRotate(e){this._rotateEnd.set(e.clientX,e.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(A*this._rotateDelta.x/t.clientHeight),this._rotateUp(A*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(e){this._dollyEnd.set(e.clientX,e.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(e){this._panEnd.set(e.clientX,e.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(e){this._updateZoomParameters(e.clientX,e.clientY),e.deltaY<0?this._dollyIn(this._getZoomScale(e.deltaY)):e.deltaY>0&&this._dollyOut(this._getZoomScale(e.deltaY)),this.update()}_handleKeyDown(e){let t=!1;switch(e.code){case this.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(A*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),t=!0;break;case this.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateUp(-A*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),t=!0;break;case this.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(A*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),t=!0;break;case this.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?this.enableRotate&&this._rotateLeft(-A*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),this.update())}_handleTouchStartRotate(e){if(this._pointers.length===1)this._rotateStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._rotateStart.set(n,s)}}_handleTouchStartPan(e){if(this._pointers.length===1)this._panStart.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._panStart.set(n,s)}}_handleTouchStartDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,s=e.pageY-t.y,o=Math.sqrt(n*n+s*s);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enablePan&&this._handleTouchStartPan(e)}_handleTouchStartDollyRotate(e){this.enableZoom&&this._handleTouchStartDolly(e),this.enableRotate&&this._handleTouchStartRotate(e)}_handleTouchMoveRotate(e){if(this._pointers.length==1)this._rotateEnd.set(e.pageX,e.pageY);else{const n=this._getSecondPointerPosition(e),s=.5*(e.pageX+n.x),o=.5*(e.pageY+n.y);this._rotateEnd.set(s,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const t=this.domElement;this._rotateLeft(A*this._rotateDelta.x/t.clientHeight),this._rotateUp(A*this._rotateDelta.y/t.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(e){if(this._pointers.length===1)this._panEnd.set(e.pageX,e.pageY);else{const t=this._getSecondPointerPosition(e),n=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);this._panEnd.set(n,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(e){const t=this._getSecondPointerPosition(e),n=e.pageX-t.x,s=e.pageY-t.y,o=Math.sqrt(n*n+s*s);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const r=(e.pageX+t.x)*.5,h=(e.pageY+t.y)*.5;this._updateZoomParameters(r,h)}_handleTouchMoveDollyPan(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enablePan&&this._handleTouchMovePan(e)}_handleTouchMoveDollyRotate(e){this.enableZoom&&this._handleTouchMoveDolly(e),this.enableRotate&&this._handleTouchMoveRotate(e)}_addPointer(e){this._pointers.push(e.pointerId)}_removePointer(e){delete this._pointerPositions[e.pointerId];for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId){this._pointers.splice(t,1);return}}_isTrackingPointer(e){for(let t=0;t<this._pointers.length;t++)if(this._pointers[t]==e.pointerId)return!0;return!1}_trackPointer(e){let t=this._pointerPositions[e.pointerId];t===void 0&&(t=new D,this._pointerPositions[e.pointerId]=t),t.set(e.pageX,e.pageY)}_getSecondPointerPosition(e){const t=e.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[t]}_customWheelEvent(e){const t=e.deltaMode,n={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:n.deltaY*=16;break;case 2:n.deltaY*=100;break}return e.ctrlKey&&!this._controlActive&&(n.deltaY*=10),n}}function at(i){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(i.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(i)&&(this._addPointer(i),i.pointerType==="touch"?this._onTouchStart(i):this._onMouseDown(i)))}function rt(i){this.enabled!==!1&&(i.pointerType==="touch"?this._onTouchMove(i):this._onMouseMove(i))}function lt(i){switch(this._removePointer(i),this._pointers.length){case 0:this.domElement.releasePointerCapture(i.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(ze),this.state=g.NONE;break;case 1:const e=this._pointers[0],t=this._pointerPositions[e];this._onTouchStart({pointerId:e,pageX:t.x,pageY:t.y});break}}function ht(i){let e;switch(i.button){case 0:e=this.mouseButtons.LEFT;break;case 1:e=this.mouseButtons.MIDDLE;break;case 2:e=this.mouseButtons.RIGHT;break;default:e=-1}switch(e){case Q.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(i),this.state=g.DOLLY;break;case Q.ROTATE:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=g.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=g.ROTATE}break;case Q.PAN:if(i.ctrlKey||i.metaKey||i.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(i),this.state=g.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(i),this.state=g.PAN}break;default:this.state=g.NONE}this.state!==g.NONE&&this.dispatchEvent(Ee)}function dt(i){switch(this.state){case g.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(i);break;case g.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(i);break;case g.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(i);break}}function ut(i){this.enabled===!1||this.enableZoom===!1||this.state!==g.NONE||(i.preventDefault(),this.dispatchEvent(Ee),this._handleMouseWheel(this._customWheelEvent(i)),this.dispatchEvent(ze))}function ct(i){this.enabled!==!1&&this._handleKeyDown(i)}function _t(i){switch(this._trackPointer(i),this._pointers.length){case 1:switch(this.touches.ONE){case Z.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(i),this.state=g.TOUCH_ROTATE;break;case Z.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(i),this.state=g.TOUCH_PAN;break;default:this.state=g.NONE}break;case 2:switch(this.touches.TWO){case Z.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(i),this.state=g.TOUCH_DOLLY_PAN;break;case Z.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(i),this.state=g.TOUCH_DOLLY_ROTATE;break;default:this.state=g.NONE}break;default:this.state=g.NONE}this.state!==g.NONE&&this.dispatchEvent(Ee)}function ft(i){switch(this._trackPointer(i),this.state){case g.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(i),this.update();break;case g.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(i),this.update();break;case g.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(i),this.update();break;case g.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(i),this.update();break;default:this.state=g.NONE}}function pt(i){this.enabled!==!1&&i.preventDefault()}function mt(i){i.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function gt(i){i.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function bt(i){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=i,document.head.appendChild(e),i}}function W(i,e){var t=i.__state.conversionName.toString(),n=Math.round(i.r),s=Math.round(i.g),o=Math.round(i.b),r=i.a,h=Math.round(i.h),d=i.s.toFixed(1),_=i.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var c=i.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}else{if(t==="CSS_RGB")return"rgb("+n+","+s+","+o+")";if(t==="CSS_RGBA")return"rgba("+n+","+s+","+o+","+r+")";if(t==="HEX")return"0x"+i.hex.toString(16);if(t==="RGB_ARRAY")return"["+n+","+s+","+o+"]";if(t==="RGBA_ARRAY")return"["+n+","+s+","+o+","+r+"]";if(t==="RGB_OBJ")return"{r:"+n+",g:"+s+",b:"+o+"}";if(t==="RGBA_OBJ")return"{r:"+n+",g:"+s+",b:"+o+",a:"+r+"}";if(t==="HSV_OBJ")return"{h:"+h+",s:"+d+",v:"+_+"}";if(t==="HSVA_OBJ")return"{h:"+h+",s:"+d+",v:"+_+",a:"+r+"}"}return"unknown format"}var Re=Array.prototype.forEach,q=Array.prototype.slice,l={BREAK:{},extend:function(e){return this.each(q.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach((function(s){this.isUndefined(t[s])||(e[s]=t[s])}).bind(this))},this),e},defaults:function(e){return this.each(q.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach((function(s){this.isUndefined(e[s])&&(e[s]=t[s])}).bind(this))},this),e},compose:function(){var e=q.call(arguments);return function(){for(var t=q.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(e){if(Re&&e.forEach&&e.forEach===Re)e.forEach(t,n);else if(e.length===e.length+0){var s=void 0,o=void 0;for(s=0,o=e.length;s<o;s++)if(s in e&&t.call(n,e[s],s)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var s=void 0;return function(){var o=this,r=arguments;function h(){s=null,n||e.apply(o,r)}var d=n||!s;clearTimeout(s),s=setTimeout(h,t),d&&e.apply(o,r)}},toArray:function(e){return e.toArray?e.toArray():q.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(i){function e(t){return i.apply(this,arguments)}return e.toString=function(){return i.toString()},e}(function(i){return isNaN(i)}),isArray:Array.isArray||function(i){return i.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},yt=[{litmus:l.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:W},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:W},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:W},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:W}}},{litmus:l.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:l.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:l.isObject,conversions:{RGBA_OBJ:{read:function(e){return l.isNumber(e.r)&&l.isNumber(e.g)&&l.isNumber(e.b)&&l.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return l.isNumber(e.r)&&l.isNumber(e.g)&&l.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return l.isNumber(e.h)&&l.isNumber(e.s)&&l.isNumber(e.v)&&l.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return l.isNumber(e.h)&&l.isNumber(e.s)&&l.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],J=void 0,re=void 0,me=function(){re=!1;var e=arguments.length>1?l.toArray(arguments):arguments[0];return l.each(yt,function(t){if(t.litmus(e))return l.each(t.conversions,function(n,s){if(J=n.read(e),re===!1&&J!==!1)return re=J,J.conversionName=s,J.conversion=n,l.BREAK}),l.BREAK}),re},Le=void 0,he={hsv_to_rgb:function(e,t,n){var s=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),r=n*(1-t),h=n*(1-o*t),d=n*(1-(1-o)*t),_=[[n,d,r],[h,n,r],[r,n,d],[r,h,n],[d,r,n],[n,r,h]][s];return{r:_[0]*255,g:_[1]*255,b:_[2]*255}},rgb_to_hsv:function(e,t,n){var s=Math.min(e,t,n),o=Math.max(e,t,n),r=o-s,h=void 0,d=void 0;if(o!==0)d=r/o;else return{h:NaN,s:0,v:0};return e===o?h=(t-n)/r:t===o?h=2+(n-e)/r:h=4+(e-t)/r,h/=6,h<0&&(h+=1),{h:h*360,s:d,v:o/255}},rgb_to_hex:function(e,t,n){var s=this.hex_with_component(0,2,e);return s=this.hex_with_component(s,1,t),s=this.hex_with_component(s,0,n),s},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,n){return n<<(Le=t*8)|e&~(255<<Le)}},vt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},L=function(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")},M=function(){function i(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),j=function i(e,t,n){e===null&&(e=Function.prototype);var s=Object.getOwnPropertyDescriptor(e,t);if(s===void 0){var o=Object.getPrototypeOf(e);return o===null?void 0:i(o,t,n)}else{if("value"in s)return s.value;var r=s.get;return r===void 0?void 0:r.call(n)}},V=function(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(i,e):i.__proto__=e)},z=function(i,e){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:i},E=function(){function i(){if(L(this,i),this.__state=me.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return M(i,[{key:"toString",value:function(){return W(this)}},{key:"toHexString",value:function(){return W(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),i}();function xe(i,e,t){Object.defineProperty(i,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(E.recalculateRGB(this,e,t),this.__state[e])},set:function(s){this.__state.space!=="RGB"&&(E.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=s}})}function Ce(i,e){Object.defineProperty(i,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(E.recalculateHSV(this),this.__state[e])},set:function(n){this.__state.space!=="HSV"&&(E.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=n}})}E.recalculateRGB=function(i,e,t){if(i.__state.space==="HEX")i.__state[e]=he.component_from_hex(i.__state.hex,t);else if(i.__state.space==="HSV")l.extend(i.__state,he.hsv_to_rgb(i.__state.h,i.__state.s,i.__state.v));else throw new Error("Corrupted color state")};E.recalculateHSV=function(i){var e=he.rgb_to_hsv(i.r,i.g,i.b);l.extend(i.__state,{s:e.s,v:e.v}),l.isNaN(e.h)?l.isUndefined(i.__state.h)&&(i.__state.h=0):i.__state.h=e.h};E.COMPONENTS=["r","g","b","h","s","v","hex","a"];xe(E.prototype,"r",2);xe(E.prototype,"g",1);xe(E.prototype,"b",0);Ce(E.prototype,"h");Ce(E.prototype,"s");Ce(E.prototype,"v");Object.defineProperty(E.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(E.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=he.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var X=function(){function i(e,t){L(this,i),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return M(i,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),i}(),wt={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},Ye={};l.each(wt,function(i,e){l.each(i,function(t){Ye[t]=e})});var Et=/(\d+(\.\d+)?)px/;function N(i){if(i==="0"||l.isUndefined(i))return 0;var e=i.match(Et);return l.isNull(e)?0:parseFloat(e[1])}var a={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var s=n,o=t;l.isUndefined(o)&&(o=!0),l.isUndefined(s)&&(s=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),s&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,s){var o=n||{},r=Ye[t];if(!r)throw new Error("Event type "+t+" not supported.");var h=document.createEvent(r);switch(r){case"MouseEvents":{var d=o.x||o.clientX||0,_=o.y||o.clientY||0;h.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,d,_,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var c=h.initKeyboardEvent||h.initKeyEvent;l.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break}default:{h.initEvent(t,o.bubbles||!1,o.cancelable||!0);break}}l.defaults(h,s),e.dispatchEvent(h)},bind:function(e,t,n,s){var o=s||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),a},unbind:function(e,t,n,s){var o=s||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),a},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);n.indexOf(t)===-1&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return a},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),s=n.indexOf(t);s!==-1&&(n.splice(s,1),e.className=n.join(" "))}else e.className=void 0;return a},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return N(t["border-left-width"])+N(t["border-right-width"])+N(t["padding-left"])+N(t["padding-right"])+N(t.width)},getHeight:function(e){var t=getComputedStyle(e);return N(t["border-top-width"])+N(t["border-bottom-width"])+N(t["padding-top"])+N(t["padding-bottom"])+N(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent;while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Ge=function(i){V(e,i);function e(t,n){L(this,e);var s=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=s;s.__prev=s.getValue(),s.__checkbox=document.createElement("input"),s.__checkbox.setAttribute("type","checkbox");function r(){o.setValue(!o.__prev)}return a.bind(s.__checkbox,"change",r,!1),s.domElement.appendChild(s.__checkbox),s.updateDisplay(),s}return M(e,[{key:"setValue",value:function(n){var s=j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),s}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(X),xt=function(i){V(e,i);function e(t,n,s){L(this,e);var o=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=s,h=o;if(o.__select=document.createElement("select"),l.isArray(r)){var d={};l.each(r,function(_){d[_]=_}),r=d}return l.each(r,function(_,c){var u=document.createElement("option");u.innerHTML=c,u.setAttribute("value",_),h.__select.appendChild(u)}),o.updateDisplay(),a.bind(o.__select,"change",function(){var _=this.options[this.selectedIndex].value;h.setValue(_)}),o.domElement.appendChild(o.__select),o}return M(e,[{key:"setValue",value:function(n){var s=j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,n);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),s}},{key:"updateDisplay",value:function(){return a.isActive(this.__select)?this:(this.__select.value=this.getValue(),j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(X),Ct=function(i){V(e,i);function e(t,n){L(this,e);var s=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),o=s;function r(){o.setValue(o.__input.value)}function h(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),a.bind(s.__input,"keyup",r),a.bind(s.__input,"change",r),a.bind(s.__input,"blur",h),a.bind(s.__input,"keydown",function(d){d.keyCode===13&&this.blur()}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return M(e,[{key:"updateDisplay",value:function(){return a.isActive(this.__input)||(this.__input.value=this.getValue()),j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(X);function Me(i){var e=i.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var Xe=function(i){V(e,i);function e(t,n,s){L(this,e);var o=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=s||{};return o.__min=r.min,o.__max=r.max,o.__step=r.step,l.isUndefined(o.__step)?o.initialValue===0?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=Me(o.__impliedStep),o}return M(e,[{key:"setValue",value:function(n){var s=n;return this.__min!==void 0&&s<this.__min?s=this.__min:this.__max!==void 0&&s>this.__max&&(s=this.__max),this.__step!==void 0&&s%this.__step!==0&&(s=Math.round(s/this.__step)*this.__step),j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,s)}},{key:"min",value:function(n){return this.__min=n,this}},{key:"max",value:function(n){return this.__max=n,this}},{key:"step",value:function(n){return this.__step=n,this.__impliedStep=n,this.__precision=Me(n),this}}]),e}(X);function St(i,e){var t=Math.pow(10,e);return Math.round(i*t)/t}var de=function(i){V(e,i);function e(t,n,s){L(this,e);var o=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,s));o.__truncationSuspended=!1;var r=o,h=void 0;function d(){var m=parseFloat(r.__input.value);l.isNaN(m)||r.setValue(m)}function _(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function c(){_()}function u(m){var f=h-m.clientY;r.setValue(r.getValue()+f*r.__impliedStep),h=m.clientY}function p(){a.unbind(window,"mousemove",u),a.unbind(window,"mouseup",p),_()}function v(m){a.bind(window,"mousemove",u),a.bind(window,"mouseup",p),h=m.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),a.bind(o.__input,"change",d),a.bind(o.__input,"blur",c),a.bind(o.__input,"mousedown",v),a.bind(o.__input,"keydown",function(m){m.keyCode===13&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,_())}),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return M(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():St(this.getValue(),this.__precision),j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Xe);function Ne(i,e,t,n,s){return n+(s-n)*((i-e)/(t-e))}var ge=function(i){V(e,i);function e(t,n,s,o,r){L(this,e);var h=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,{min:s,max:o,step:r})),d=h;h.__background=document.createElement("div"),h.__foreground=document.createElement("div"),a.bind(h.__background,"mousedown",_),a.bind(h.__background,"touchstart",p),a.addClass(h.__background,"slider"),a.addClass(h.__foreground,"slider-fg");function _(f){document.activeElement.blur(),a.bind(window,"mousemove",c),a.bind(window,"mouseup",u),c(f)}function c(f){f.preventDefault();var y=d.__background.getBoundingClientRect();return d.setValue(Ne(f.clientX,y.left,y.right,d.__min,d.__max)),!1}function u(){a.unbind(window,"mousemove",c),a.unbind(window,"mouseup",u),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}function p(f){f.touches.length===1&&(a.bind(window,"touchmove",v),a.bind(window,"touchend",m),v(f))}function v(f){var y=f.touches[0].clientX,T=d.__background.getBoundingClientRect();d.setValue(Ne(y,T.left,T.right,d.__min,d.__max))}function m(){a.unbind(window,"touchmove",v),a.unbind(window,"touchend",m),d.__onFinishChange&&d.__onFinishChange.call(d,d.getValue())}return h.updateDisplay(),h.__background.appendChild(h.__foreground),h.domElement.appendChild(h.__background),h}return M(e,[{key:"updateDisplay",value:function(){var n=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=n*100+"%",j(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Xe),Ke=function(i){V(e,i);function e(t,n,s){L(this,e);var o=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n)),r=o;return o.__button=document.createElement("div"),o.__button.innerHTML=s===void 0?"Fire":s,a.bind(o.__button,"click",function(h){return h.preventDefault(),r.fire(),!1}),a.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return M(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(X),be=function(i){V(e,i);function e(t,n){L(this,e);var s=z(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));s.__color=new E(s.getValue()),s.__temp=new E(0);var o=s;s.domElement=document.createElement("div"),a.makeSelectable(s.domElement,!1),s.__selector=document.createElement("div"),s.__selector.className="selector",s.__saturation_field=document.createElement("div"),s.__saturation_field.className="saturation-field",s.__field_knob=document.createElement("div"),s.__field_knob.className="field-knob",s.__field_knob_border="2px solid ",s.__hue_knob=document.createElement("div"),s.__hue_knob.className="hue-knob",s.__hue_field=document.createElement("div"),s.__hue_field.className="hue-field",s.__input=document.createElement("input"),s.__input.type="text",s.__input_textShadow="0 1px 1px ",a.bind(s.__input,"keydown",function(f){f.keyCode===13&&u.call(this)}),a.bind(s.__input,"blur",u),a.bind(s.__selector,"mousedown",function(){a.addClass(this,"drag").bind(window,"mouseup",function(){a.removeClass(o.__selector,"drag")})}),a.bind(s.__selector,"touchstart",function(){a.addClass(this,"drag").bind(window,"touchend",function(){a.removeClass(o.__selector,"drag")})});var r=document.createElement("div");l.extend(s.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),l.extend(s.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:s.__field_knob_border+(s.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),l.extend(s.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),l.extend(s.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),l.extend(r.style,{width:"100%",height:"100%",background:"none"}),Fe(r,"top","rgba(0,0,0,0)","#000"),l.extend(s.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),Ot(s.__hue_field),l.extend(s.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:s.__input_textShadow+"rgba(0,0,0,0.7)"}),a.bind(s.__saturation_field,"mousedown",h),a.bind(s.__saturation_field,"touchstart",h),a.bind(s.__field_knob,"mousedown",h),a.bind(s.__field_knob,"touchstart",h),a.bind(s.__hue_field,"mousedown",d),a.bind(s.__hue_field,"touchstart",d);function h(f){v(f),a.bind(window,"mousemove",v),a.bind(window,"touchmove",v),a.bind(window,"mouseup",_),a.bind(window,"touchend",_)}function d(f){m(f),a.bind(window,"mousemove",m),a.bind(window,"touchmove",m),a.bind(window,"mouseup",c),a.bind(window,"touchend",c)}function _(){a.unbind(window,"mousemove",v),a.unbind(window,"touchmove",v),a.unbind(window,"mouseup",_),a.unbind(window,"touchend",_),p()}function c(){a.unbind(window,"mousemove",m),a.unbind(window,"touchmove",m),a.unbind(window,"mouseup",c),a.unbind(window,"touchend",c),p()}function u(){var f=me(this.value);f!==!1?(o.__color.__state=f,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function p(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}s.__saturation_field.appendChild(r),s.__selector.appendChild(s.__field_knob),s.__selector.appendChild(s.__saturation_field),s.__selector.appendChild(s.__hue_field),s.__hue_field.appendChild(s.__hue_knob),s.domElement.appendChild(s.__input),s.domElement.appendChild(s.__selector),s.updateDisplay();function v(f){f.type.indexOf("touch")===-1&&f.preventDefault();var y=o.__saturation_field.getBoundingClientRect(),T=f.touches&&f.touches[0]||f,F=T.clientX,O=T.clientY,P=(F-y.left)/(y.right-y.left),S=1-(O-y.top)/(y.bottom-y.top);return S>1?S=1:S<0&&(S=0),P>1?P=1:P<0&&(P=0),o.__color.v=S,o.__color.s=P,o.setValue(o.__color.toOriginal()),!1}function m(f){f.type.indexOf("touch")===-1&&f.preventDefault();var y=o.__hue_field.getBoundingClientRect(),T=f.touches&&f.touches[0]||f,F=T.clientY,O=1-(F-y.top)/(y.bottom-y.top);return O>1?O=1:O<0&&(O=0),o.__color.h=O*360,o.setValue(o.__color.toOriginal()),!1}return s}return M(e,[{key:"updateDisplay",value:function(){var n=me(this.getValue());if(n!==!1){var s=!1;l.each(E.COMPONENTS,function(h){if(!l.isUndefined(n[h])&&!l.isUndefined(this.__color.__state[h])&&n[h]!==this.__color.__state[h])return s=!0,{}},this),s&&l.extend(this.__color.__state,n)}l.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var o=this.__color.v<.5||this.__color.s>.5?255:0,r=255-o;l.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+o+","+o+","+o+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,Fe(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),l.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+o+","+o+","+o+")",textShadow:this.__input_textShadow+"rgba("+r+","+r+","+r+",.7)"})}}]),e}(X),At=["-moz-","-o-","-webkit-","-ms-",""];function Fe(i,e,t,n){i.style.background="",l.each(At,function(s){i.style.cssText+="background: "+s+"linear-gradient("+e+", "+t+" 0%, "+n+" 100%); "})}function Ot(i){i.style.background="",i.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",i.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Tt={load:function(e,t){var n=t||document,s=n.createElement("link");s.type="text/css",s.rel="stylesheet",s.href=e,n.getElementsByTagName("head")[0].appendChild(s)},inject:function(e,t){var n=t||document,s=document.createElement("style");s.type="text/css",s.innerHTML=e;var o=n.getElementsByTagName("head")[0];try{o.appendChild(s)}catch{}}},kt=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,Pt=function(e,t){var n=e[t];return l.isArray(arguments[2])||l.isObject(arguments[2])?new xt(e,t,arguments[2]):l.isNumber(n)?l.isNumber(arguments[2])&&l.isNumber(arguments[3])?l.isNumber(arguments[4])?new ge(e,t,arguments[2],arguments[3],arguments[4]):new ge(e,t,arguments[2],arguments[3]):l.isNumber(arguments[4])?new de(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new de(e,t,{min:arguments[2],max:arguments[3]}):l.isString(n)?new Ct(e,t):l.isFunction(n)?new Ke(e,t,""):l.isBoolean(n)?new Ge(e,t):null};function Dt(i){setTimeout(i,1e3/60)}var Rt=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Dt,Lt=function(){function i(){L(this,i),this.backgroundElement=document.createElement("div"),l.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),a.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),l.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;a.bind(this.backgroundElement,"click",function(){e.hide()})}return M(i,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),l.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,n=function s(){t.domElement.style.display="none",t.backgroundElement.style.display="none",a.unbind(t.domElement,"webkitTransitionEnd",s),a.unbind(t.domElement,"transitionend",s),a.unbind(t.domElement,"oTransitionEnd",s)};a.bind(this.domElement,"webkitTransitionEnd",n),a.bind(this.domElement,"transitionend",n),a.bind(this.domElement,"oTransitionEnd",n),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-a.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-a.getHeight(this.domElement)/2+"px"}}]),i}(),Mt=bt(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);Tt.inject(Mt);var He="dg",Be=72,Ie=20,ne="Default",ee=function(){try{return!!window.localStorage}catch{return!1}}(),te=void 0,Ue=!0,K=void 0,pe=!1,$e=[],b=function i(e){var t=this,n=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),a.addClass(this.domElement,He),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=l.defaults(n,{closeOnTop:!1,autoPlace:!0,width:i.DEFAULT_WIDTH}),n=l.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),l.isUndefined(n.load)?n.load={preset:ne}:n.preset&&(n.load.preset=n.preset),l.isUndefined(n.parent)&&n.hideable&&$e.push(this),n.resizable=l.isUndefined(n.parent)&&n.resizable,n.autoPlace&&l.isUndefined(n.scrollable)&&(n.scrollable=!0);var s=ee&&localStorage.getItem($(this,"isLocal"))==="true",o=void 0,r=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:n.load.preset},set:function(p){t.parent?t.getRoot().preset=p:n.load.preset=p,Bt(this),t.revert()}},width:{get:function(){return n.width},set:function(p){n.width=p,we(t,p)}},name:{get:function(){return n.name},set:function(p){n.name=p,r&&(r.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(p){n.closed=p,n.closed?a.addClass(t.__ul,i.CLASS_CLOSED):a.removeClass(t.__ul,i.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=p?i.TEXT_OPEN:i.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return s},set:function(p){ee&&(s=p,p?a.bind(window,"unload",o):a.unbind(window,"unload",o),localStorage.setItem($(t,"isLocal"),p))}}}),l.isUndefined(n.parent)){if(this.closed=n.closed||!1,a.addClass(this.domElement,i.CLASS_MAIN),a.makeSelectable(this.domElement,!1),ee&&s){t.useLocalStorage=!0;var h=localStorage.getItem($(this,"gui"));h&&(n.load=JSON.parse(h))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=i.TEXT_CLOSED,a.addClass(this.__closeButton,i.CLASS_CLOSE_BUTTON),n.closeOnTop?(a.addClass(this.__closeButton,i.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(a.addClass(this.__closeButton,i.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),a.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{n.closed===void 0&&(n.closed=!0);var d=document.createTextNode(n.name);a.addClass(d,"controller-name"),r=Se(t,d);var _=function(p){return p.preventDefault(),t.closed=!t.closed,!1};a.addClass(this.__ul,i.CLASS_CLOSED),a.addClass(r,"title"),a.bind(r,"click",_),n.closed||(this.closed=!1)}n.autoPlace&&(l.isUndefined(n.parent)&&(Ue&&(K=document.createElement("div"),a.addClass(K,He),a.addClass(K,i.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(K),Ue=!1),K.appendChild(this.domElement),a.addClass(this.domElement,i.CLASS_AUTO_PLACE)),this.parent||we(t,n.width)),this.__resizeHandler=function(){t.onResizeDebounced()},a.bind(window,"resize",this.__resizeHandler),a.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),a.bind(this.__ul,"transitionend",this.__resizeHandler),a.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&Ht(this),o=function(){ee&&localStorage.getItem($(t,"isLocal"))==="true"&&localStorage.setItem($(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=o;function c(){var u=t.getRoot();u.width+=1,l.defer(function(){u.width-=1})}n.parent||c()};b.toggleHide=function(){pe=!pe,l.each($e,function(i){i.domElement.style.display=pe?"none":""})};b.CLASS_AUTO_PLACE="a";b.CLASS_AUTO_PLACE_CONTAINER="ac";b.CLASS_MAIN="main";b.CLASS_CONTROLLER_ROW="cr";b.CLASS_TOO_TALL="taller-than-window";b.CLASS_CLOSED="closed";b.CLASS_CLOSE_BUTTON="close-button";b.CLASS_CLOSE_TOP="close-top";b.CLASS_CLOSE_BOTTOM="close-bottom";b.CLASS_DRAG="drag";b.DEFAULT_WIDTH=245;b.TEXT_CLOSED="Close Controls";b.TEXT_OPEN="Open Controls";b._keydownHandler=function(i){document.activeElement.type!=="text"&&(i.which===Be||i.keyCode===Be)&&b.toggleHide()};a.bind(window,"keydown",b._keydownHandler,!1);l.extend(b.prototype,{add:function(e,t){return ie(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return ie(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;l.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&K.removeChild(this.domElement);var e=this;l.each(this.__folders,function(t){e.removeFolder(t)}),a.unbind(window,"keydown",b._keydownHandler,!1),je(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new b(t);this.__folders[e]=n;var s=Se(this,n.domElement);return a.addClass(s,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],je(e);var t=this;l.each(e.__folders,function(n){e.removeFolder(n)}),l.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=a.getOffset(e.__ul).top,n=0;l.each(e.__ul.childNodes,function(s){e.autoPlace&&s===e.__save_row||(n+=a.getHeight(s))}),window.innerHeight-t-Ie<n?(a.addClass(e.domElement,b.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-Ie+"px"):(a.removeClass(e.domElement,b.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&l.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:l.debounce(function(){this.onResize()},50),remember:function(){if(l.isUndefined(te)&&(te=new Lt,te.domElement.innerHTML=kt),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;l.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&Ft(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&we(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=le(this)),e.folders={},l.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=le(this),ye(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[ne]=le(this,!0)),this.load.remembered[e]=le(this),this.preset=e,ve(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){l.each(this.__controllers,function(t){this.getRoot().load.remembered?Ze(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),l.each(this.__folders,function(t){t.revert(t)}),e||ye(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&We(this.__listening)},updateDisplay:function(){l.each(this.__controllers,function(e){e.updateDisplay()}),l.each(this.__folders,function(e){e.updateDisplay()})}});function Se(i,e,t){var n=document.createElement("li");return e&&n.appendChild(e),t?i.__ul.insertBefore(n,t):i.__ul.appendChild(n),i.onResize(),n}function je(i){a.unbind(window,"resize",i.__resizeHandler),i.saveToLocalStorageIfPossible&&a.unbind(window,"unload",i.saveToLocalStorageIfPossible)}function ye(i,e){var t=i.__preset_select[i.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function Nt(i,e,t){if(t.__li=e,t.__gui=i,l.extend(t,{options:function(r){if(arguments.length>1){var h=t.__li.nextElementSibling;return t.remove(),ie(i,t.object,t.property,{before:h,factoryArgs:[l.toArray(arguments)]})}if(l.isArray(r)||l.isObject(r)){var d=t.__li.nextElementSibling;return t.remove(),ie(i,t.object,t.property,{before:d,factoryArgs:[r]})}},name:function(r){return t.__li.firstElementChild.firstElementChild.innerHTML=r,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof ge){var n=new de(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});l.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(o){var r=t[o],h=n[o];t[o]=n[o]=function(){var d=Array.prototype.slice.call(arguments);return h.apply(n,d),r.apply(t,d)}}),a.addClass(e,"has-slider"),t.domElement.insertBefore(n.domElement,t.domElement.firstElementChild)}else if(t instanceof de){var s=function(r){if(l.isNumber(t.__min)&&l.isNumber(t.__max)){var h=t.__li.firstElementChild.firstElementChild.innerHTML,d=t.__gui.__listening.indexOf(t)>-1;t.remove();var _=ie(i,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return _.name(h),d&&_.listen(),_}return r};t.min=l.compose(s,t.min),t.max=l.compose(s,t.max)}else t instanceof Ge?(a.bind(e,"click",function(){a.fakeEvent(t.__checkbox,"click")}),a.bind(t.__checkbox,"click",function(o){o.stopPropagation()})):t instanceof Ke?(a.bind(e,"click",function(){a.fakeEvent(t.__button,"click")}),a.bind(e,"mouseover",function(){a.addClass(t.__button,"hover")}),a.bind(e,"mouseout",function(){a.removeClass(t.__button,"hover")})):t instanceof be&&(a.addClass(e,"color"),t.updateDisplay=l.compose(function(o){return e.style.borderLeftColor=t.__color.toString(),o},t.updateDisplay),t.updateDisplay());t.setValue=l.compose(function(o){return i.getRoot().__preset_select&&t.isModified()&&ye(i.getRoot(),!0),o},t.setValue)}function Ze(i,e){var t=i.getRoot(),n=t.__rememberedObjects.indexOf(e.object);if(n!==-1){var s=t.__rememberedObjectIndecesToControllers[n];if(s===void 0&&(s={},t.__rememberedObjectIndecesToControllers[n]=s),s[e.property]=e,t.load&&t.load.remembered){var o=t.load.remembered,r=void 0;if(o[i.preset])r=o[i.preset];else if(o[ne])r=o[ne];else return;if(r[n]&&r[n][e.property]!==void 0){var h=r[n][e.property];e.initialValue=h,e.setValue(h)}}}}function ie(i,e,t,n){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var s=void 0;if(n.color)s=new be(e,t);else{var o=[e,t].concat(n.factoryArgs);s=Pt.apply(i,o)}n.before instanceof X&&(n.before=n.before.__li),Ze(i,s),a.addClass(s.domElement,"c");var r=document.createElement("span");a.addClass(r,"property-name"),r.innerHTML=s.property;var h=document.createElement("div");h.appendChild(r),h.appendChild(s.domElement);var d=Se(i,h,n.before);return a.addClass(d,b.CLASS_CONTROLLER_ROW),s instanceof be?a.addClass(d,"color"):a.addClass(d,vt(s.getValue())),Nt(i,d,s),i.__controllers.push(s),s}function $(i,e){return document.location.href+"."+e}function ve(i,e,t){var n=document.createElement("option");n.innerHTML=e,n.value=e,i.__preset_select.appendChild(n),t&&(i.__preset_select.selectedIndex=i.__preset_select.length-1)}function Ve(i,e){e.style.display=i.useLocalStorage?"block":"none"}function Ft(i){var e=i.__save_row=document.createElement("li");a.addClass(i.domElement,"has-save"),i.__ul.insertBefore(e,i.__ul.firstChild),a.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",a.addClass(t,"button gears");var n=document.createElement("span");n.innerHTML="Save",a.addClass(n,"button"),a.addClass(n,"save");var s=document.createElement("span");s.innerHTML="New",a.addClass(s,"button"),a.addClass(s,"save-as");var o=document.createElement("span");o.innerHTML="Revert",a.addClass(o,"button"),a.addClass(o,"revert");var r=i.__preset_select=document.createElement("select");if(i.load&&i.load.remembered?l.each(i.load.remembered,function(u,p){ve(i,p,p===i.preset)}):ve(i,ne,!1),a.bind(r,"change",function(){for(var u=0;u<i.__preset_select.length;u++)i.__preset_select[u].innerHTML=i.__preset_select[u].value;i.preset=this.value}),e.appendChild(r),e.appendChild(t),e.appendChild(n),e.appendChild(s),e.appendChild(o),ee){var h=document.getElementById("dg-local-explain"),d=document.getElementById("dg-local-storage"),_=document.getElementById("dg-save-locally");_.style.display="block",localStorage.getItem($(i,"isLocal"))==="true"&&d.setAttribute("checked","checked"),Ve(i,h),a.bind(d,"change",function(){i.useLocalStorage=!i.useLocalStorage,Ve(i,h)})}var c=document.getElementById("dg-new-constructor");a.bind(c,"keydown",function(u){u.metaKey&&(u.which===67||u.keyCode===67)&&te.hide()}),a.bind(t,"click",function(){c.innerHTML=JSON.stringify(i.getSaveObject(),void 0,2),te.show(),c.focus(),c.select()}),a.bind(n,"click",function(){i.save()}),a.bind(s,"click",function(){var u=prompt("Enter a new preset name.");u&&i.saveAs(u)}),a.bind(o,"click",function(){i.revert()})}function Ht(i){var e=void 0;i.__resize_handle=document.createElement("div"),l.extend(i.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(o){return o.preventDefault(),i.width+=e-o.clientX,i.onResize(),e=o.clientX,!1}function n(){a.removeClass(i.__closeButton,b.CLASS_DRAG),a.unbind(window,"mousemove",t),a.unbind(window,"mouseup",n)}function s(o){return o.preventDefault(),e=o.clientX,a.addClass(i.__closeButton,b.CLASS_DRAG),a.bind(window,"mousemove",t),a.bind(window,"mouseup",n),!1}a.bind(i.__resize_handle,"mousedown",s),a.bind(i.__closeButton,"mousedown",s),i.domElement.insertBefore(i.__resize_handle,i.domElement.firstElementChild)}function we(i,e){i.domElement.style.width=e+"px",i.__save_row&&i.autoPlace&&(i.__save_row.style.width=e+"px"),i.__closeButton&&(i.__closeButton.style.width=e+"px")}function le(i,e){var t={};return l.each(i.__rememberedObjects,function(n,s){var o={},r=i.__rememberedObjectIndecesToControllers[s];l.each(r,function(h,d){o[d]=e?h.initialValue:h.getValue()}),t[s]=o}),t}function Bt(i){for(var e=0;e<i.__preset_select.length;e++)i.__preset_select[e].value===i.preset&&(i.__preset_select.selectedIndex=e)}function We(i){i.length!==0&&Rt.call(window,function(){We(i)}),l.each(i,function(e){e.updateDisplay()})}var Vt=b;export{Vt as G,jt as O,Ut as S};
