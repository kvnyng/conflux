import{S as M,P as I,W as _,V as v,M as $,d as N,e as B,D,A as O,B as nt,a as ot,c as it,b as at}from"./three.module-DaOiP1Qo.js";import{S as G,O as W,G as U}from"./dat.gui.module-D-xaz02A.js";const st="http://api.cosmicimprint.org",rt=st+"/palm/latest/";fetch(rt).then(t=>{if(!t.ok)throw new Error(`HTTP error! Status: ${t.status}`);return t.blob()}).then(t=>{const e=URL.createObjectURL(t),o=document.getElementById("handPrint");o.src=e,console.log("Got the image")}).catch(t=>{console.error("Error fetching the image:",t)});const ct="http://api.cosmicimprint.org",dt=ct+"/landscape/latest/",l=document.getElementById("middleColumnCanvas"),P=document.getElementById("middleColumn"),lt=new G,h=new M,s=new I(75,l.clientWidth/l.clientHeight,.1,1e3),w=new _({canvas:l,alpha:!0});w.setClearColor(0,0);w.setSize(l.clientWidth,l.clientHeight);let c,p,i,f=10,y=.001,R=0,z=1,u=50;const T=10,mt=20;let a=new v(0,0,0);function F(t){const e=t.max.x-t.min.x,o=t.max.y-t.min.y,n=t.max.z-t.min.z,g=Math.max(e,o,n),r=l.clientWidth/l.clientHeight;return g*1.5/Math.tan(s.fov*Math.PI/360)/r}fetch(dt).then(t=>{if(!t.ok)throw new Error(`Failed to fetch STL file: ${t.statusText}`);return t.blob()}).then(t=>{const e=URL.createObjectURL(t);lt.load(e,function(o){o.computeBoundingBox(),o.center();const n=o.boundingBox;a=new v((n.max.x+n.min.x)/2,(n.max.y+n.min.y)/2,(n.max.z+n.min.z)/2),u=(n.max.z-n.min.z)*1.5;const r=new $({color:16777215,roughness:.5,metalness:.2});c=new N(o,r),c.scale.set(T,T,T),h.add(c),f=F(n),p=new B(16777215,mt),p.position.set(50,50,50),h.add(p);const m=new D(16777215,1);m.position.set(-50,60,150),h.add(m),c.add(p),s.position.set(a.x+f,a.y+u,a.z),s.lookAt(a),i=new W(s,w.domElement),i.enableDamping=!0,i.dampingFactor=.05,i.enableZoom=!0,i.enablePan=!1,i.rotateSpeed=.8,i.target.set(a.x,a.y,a.z),i.update()})}).catch(t=>{console.error("Error loading STL file:",t)});const ft=new O(16777215,.2);h.add(ft);function V(){if(requestAnimationFrame(V),c&&(!i||!i.mouseButtons.LEFT)){R+=y;const t=f/z;s.position.x=a.x+t*Math.cos(R),s.position.z=a.z+t*Math.sin(R),s.position.y=a.y+u,s.lookAt(a)}i&&i.update(),w.render(h,s)}V();function ht(){const t=P.clientWidth,e=P.clientHeight;if(w.setSize(t,e),s.aspect=t/e,s.updateProjectionMatrix(),c){const o=c.geometry.boundingBox;f=F(o)}}window.addEventListener("resize",ht);const S=new U,E={orbitRadius:f,orbitSpeed:y,zoomScale:z,orbitHeight:u};S.add(E,"orbitRadius",10,50).onChange(t=>{f=t});S.add(E,"orbitSpeed",1e-4,.01).onChange(t=>{y=t});S.add(E,"zoomScale",.5,5).onChange(t=>{z=t});S.add(E,"orbitHeight",10,200).onChange(t=>{u=t});console.log("Loaded second column landscape script");const ut=document.getElementById("bg"),k=new M,j=new I(75,window.innerWidth/window.innerHeight,.1,1e3),C=new _({canvas:ut});C.setPixelRatio(window.devicePixelRatio);C.setSize(window.innerWidth,window.innerHeight);j.position.setZ(1);const Y=new nt,wt=new ot({color:16777215}),q=1e4,x=new Float32Array(q*3);for(let t=0;t<q;t++)x[t*3]=(Math.random()-.5)*2e3,x[t*3+1]=(Math.random()-.5)*2e3,x[t*3+2]=(Math.random()-.5)*2e3;Y.setAttribute("position",new it(x,3));const X=new at(Y,wt);k.add(X);function Z(){requestAnimationFrame(Z),X.rotation.y+=5e-4,C.render(k,j)}Z();const J="http://api.cosmicimprint.org",K=J+"/planet/latest/",gt=document.getElementById("leftColumnCanvas"),pt=new G,H=new M,d=new I(75,window.innerWidth/2/window.innerHeight,.1,1e3),b=new _({canvas:gt,alpha:!0});b.setClearColor(0,0);b.setSize(window.innerWidth/2,window.innerHeight);d.position.z=5;const Lt=20,xt=-50,St=60,Et=150;async function Q(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`Failed to fetch STL file: ${e.statusText}`);return await e.blob()}catch(e){return console.error("Error loading STL file:",e),null}}function tt(t,e){if(!t)return;const o=URL.createObjectURL(t);pt.load(o,function(n){const g=new $({color:16777215,roughness:.5,metalness:.2}),r=new N(n,g);r.rotation.x=Math.PI/2,r.scale.set(20,20,20),e.add(r);const m=new B(16777215,Lt);m.position.set(50,50,50),e.add(m);const A=new D(16777215,1);A.position.set(xt,St,Et),e.add(A),r.add(m)})}Q(K).then(t=>tt(t,H));document.addEventListener("mousedown",t=>{t.clientX,t.clientY});document.addEventListener("mouseup",()=>{});document.addEventListener("mousemove",t=>{});const bt=new O(16777215,.2);H.add(bt);d.position.set(0,0,100);const L={x:0,y:0,z:0},Rt=5e-4,Tt=75e-5;function Mt(){L.x=Math.sin(Date.now()*Rt)*5,L.y=Math.sin(Date.now()*Tt)*3,d.position.x=L.x,d.position.y=L.y,d.lookAt(0,0,0)}new W(d,b.domElement);function et(){requestAnimationFrame(et),Mt(),b.render(H,d)}et();new U;async function It(){console.log("Fetching new STL file...");const t=await Q(K);t&&tt(t)}const _t=new EventSource(J+"/notifications/");_t.onmessage=t=>{const e=JSON.parse(t.data);console.log("Push Notification:",e.message),alert(`New Notification: ${e.message}`),It()};
